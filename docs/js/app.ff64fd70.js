(function(){"use strict";var e={2559:function(e,t,s){var o=s(3751),a=s(641),n=s(33);const c={key:0,class:"position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{background:"rgba(0,0,0,0.4)","z-index":"1050"}},l={class:"bg-white rounded shadow p-4",style:{"min-width":"360px","max-width":"480px"}},i={class:"d-flex justify-content-between align-items-center mb-2"},r={class:"mb-0"},d={key:0},u={key:1},h={key:0},m={key:1,class:"text-muted"},p={key:2,class:"list-group mb-3",style:{"max-height":"260px","overflow-y":"auto"}},k={class:"flex-grow-1 me-3"},b={class:"small text-muted"},v={class:"d-flex align-items-center"},g=["onClick"],y={class:"mx-2"},C=["onClick"],f=["onClick"],L={class:"d-flex justify-content-center gap-2"},w=["disabled"],x={class:"container mt-3"},_={key:0},E={key:1},A={class:"mb-3"},j={key:2},F={class:"row"},X={class:"col-md-6"},P={key:0,class:"col-md-6"};function M(e,t,s,o,M,T){const $=(0,a.g2)("navbar"),q=(0,a.g2)("LessonList"),I=(0,a.g2)("Cart"),N=(0,a.g2)("Checkout");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)($,{pages:M.pages,"active-page":M.activePage,"nav-link-click":T.handleNavClick,cart:M.cart,onOpenCart:T.openCartFromIcon},null,8,["pages","active-page","nav-link-click","cart","onOpenCart"]),M.showAddedModal.visible?((0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("div",l,[(0,a.Lk)("div",i,[(0,a.Lk)("h5",r,[M.showAddedModal.fromCartIcon?((0,a.uX)(),(0,a.CE)("span",d,"Your cart")):((0,a.uX)(),(0,a.CE)("span",u,"Item added to cart"))]),(0,a.Lk)("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:t[0]||(t[0]=(...e)=>T.closeModal&&T.closeModal(...e))})]),!M.showAddedModal.fromCartIcon&&M.showAddedModal.lessonName?((0,a.uX)(),(0,a.CE)("p",h,[(0,a.Lk)("strong",null,(0,n.v_)(M.showAddedModal.lessonName),1),t[3]||(t[3]=(0,a.eW)(" has been added to your cart. ",-1))])):(0,a.Q3)("",!0),0===M.cart.length?((0,a.uX)(),(0,a.CE)("div",m," Your cart is empty. ")):((0,a.uX)(),(0,a.CE)("ul",p,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(M.cart,(e,t)=>((0,a.uX)(),(0,a.CE)("li",{key:e.lesson._id||t,class:"list-group-item d-flex justify-content-between align-items-center"},[(0,a.Lk)("div",k,[(0,a.Lk)("strong",null,(0,n.v_)(e.lesson.subject),1),(0,a.Lk)("div",b,(0,n.v_)(e.lesson.location),1)]),(0,a.Lk)("div",v,[(0,a.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:e=>T.decreaseQuantity(t)},"-",8,g),(0,a.Lk)("span",y,(0,n.v_)(e.quantity),1),(0,a.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:e=>T.increaseQuantity(t)},"+",8,C),(0,a.Lk)("button",{class:"btn btn-sm btn-outline-danger ms-2",onClick:e=>T.removeFromCart(t)}," Remove ",8,f)])]))),128))])),(0,a.Lk)("div",L,[(0,a.Lk)("button",{class:"btn btn-outline-secondary",onClick:t[1]||(t[1]=(...e)=>T.continueShoppingFromModal&&T.continueShoppingFromModal(...e))}," Continue shopping "),(0,a.Lk)("button",{class:"btn btn-primary",disabled:0===M.cart.length,onClick:t[2]||(t[2]=(...e)=>T.goToCheckoutFromModal&&T.goToCheckoutFromModal(...e))}," Go to checkout ",8,w)])])])):(0,a.Q3)("",!0),(0,a.Lk)("div",x,[0===M.activePage?((0,a.uX)(),(0,a.CE)("div",_,[(0,a.bF)(q,{page:M.pages[0],"add-to-cart":T.addToCart},null,8,["page","add-to-cart"])])):1===M.activePage?((0,a.uX)(),(0,a.CE)("div",E,[(0,a.Lk)("h1",A,(0,n.v_)(M.pages[1].pageTitle),1),(0,a.Lk)("p",null,(0,n.v_)(M.pages[1].content),1)])):2===M.activePage?((0,a.uX)(),(0,a.CE)("div",j,[t[5]||(t[5]=(0,a.Lk)("h1",{class:"mb-3"},"Checkout",-1)),(0,a.Lk)("div",F,[(0,a.Lk)("div",X,[(0,a.bF)(I,{cart:M.cart,onRemoveItem:T.removeFromCart,onIncreaseQty:T.increaseQuantity,onDecreaseQty:T.decreaseQuantity},null,8,["cart","onRemoveItem","onIncreaseQty","onDecreaseQty"])]),M.showCheckoutForm&&M.cart.length>0?((0,a.uX)(),(0,a.CE)("div",P,[t[4]||(t[4]=(0,a.Lk)("h2",{class:"h4 mb-3"},"Checkout",-1)),(0,a.bF)(N,{cart:M.cart,onCheckout:T.completeCheckout},null,8,["cart","onCheckout"])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)])])}s(4114),s(8111),s(116);const T={class:"navbar navbar-expand-lg navbar-light bg-light",style:{padding:"0.5rem 1.2rem","border-bottom":"1px solid #ddd"}},$={class:"container"},q={class:"navbar-nav me-auto mb-2 mb-lg-0"},I=["onClick"],N=["disabled"],O={key:0,class:"badge rounded-pill bg-danger",style:{position:"absolute",top:"2px",right:"4px","font-size":"0.85rem","min-width":"18px"}};function Q(e,t,s,c,l,i){return(0,a.uX)(),(0,a.CE)("nav",T,[(0,a.Lk)("div",$,[t[3]||(t[3]=(0,a.Lk)("a",{class:"navbar-brand fw-semibold",style:{"font-size":"1.55rem","font-weight":"600"}}," After School Lessons ",-1)),(0,a.Lk)("ul",q,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.pages,(e,t)=>((0,a.uX)(),(0,a.CE)("li",{key:t,class:"nav-item"},[(0,a.Lk)("a",{href:"#",class:(0,n.C4)(["nav-link",{active:s.activePage===t}]),onClick:(0,o.D$)(e=>s.navLinkClick(t),["prevent"]),style:{"font-size":"1.15rem","font-weight":"500"}},(0,n.v_)(e.link.text),11,I)]))),128))]),(0,a.Lk)("button",{class:"btn btn-light position-relative d-flex flex-column align-items-center justify-content-center",disabled:0===i.cartCount,onClick:t[0]||(t[0]=t=>e.$emit("open-cart")),style:{width:"80px",height:"80px","border-radius":"9999px",padding:"6px"}},[t[1]||(t[1]=(0,a.Lk)("i",{class:"bi bi-cart2",style:{"font-size":"2.1rem"}},null,-1)),t[2]||(t[2]=(0,a.Lk)("span",{style:{"font-size":"0.95rem","margin-top":"3px"}},"Cart",-1)),i.cartCount>0?((0,a.uX)(),(0,a.CE)("span",O,(0,n.v_)(i.cartCount),1)):(0,a.Q3)("",!0)],8,N)])])}s(8237);var S={name:"Navbar",props:["pages","activePage","navLinkClick","cart"],computed:{cartCount(){return Array.isArray(this.cart)?this.cart.reduce((e,t)=>e+(t.quantity||0),0):0}}},V=s(6262);const D=(0,V.A)(S,[["render",Q]]);var K=D;const z={class:"container mt-4"},U={class:"mb-4"},R={class:"row mb-3"},J={class:"col-md-6"},Y={class:"row mb-3"},G={class:"col-md-4"},W={class:"col-md-4"},Z={class:"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4"},B={class:"card h-100 shadow-sm"},H=["src","alt"],ee={class:"card-body"},te={class:"card-title"},se={class:"card-text text-muted mb-2"},oe={class:"mb-2"},ae=["onClick","disabled"];function ne(e,t,s,c,l,i){return(0,a.uX)(),(0,a.CE)("div",z,[(0,a.Lk)("h1",U,(0,n.v_)(s.page.pageTitle),1),(0,a.Lk)("div",R,[(0,a.Lk)("div",J,[t[4]||(t[4]=(0,a.Lk)("label",{class:"form-label"},"Search",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>l.searchTerm=e),onInput:t[1]||(t[1]=(...e)=>i.searchLessons&&i.searchLessons(...e)),type:"text",class:"form-control",placeholder:"Search by subject, location, price, spaces..."},null,544),[[o.Jo,l.searchTerm]])])]),(0,a.Lk)("div",Y,[(0,a.Lk)("div",G,[t[6]||(t[6]=(0,a.Lk)("label",{class:"form-label"},"Sort by",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>l.sortKey=e),class:"form-select"},[...t[5]||(t[5]=[(0,a.Lk)("option",{value:"subject"},"Subject",-1),(0,a.Lk)("option",{value:"location"},"Location",-1),(0,a.Lk)("option",{value:"price"},"Price",-1),(0,a.Lk)("option",{value:"spaces"},"Spaces",-1)])],512),[[o.u1,l.sortKey]])]),(0,a.Lk)("div",W,[t[8]||(t[8]=(0,a.Lk)("label",{class:"form-label"},"Order",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>l.sortDir=e),class:"form-select"},[...t[7]||(t[7]=[(0,a.Lk)("option",{value:"asc"},"Ascending",-1),(0,a.Lk)("option",{value:"desc"},"Descending",-1)])],512),[[o.u1,l.sortDir]])])]),(0,a.Lk)("div",Z,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.sortedLessons,e=>((0,a.uX)(),(0,a.CE)("div",{class:"col",key:e._id},[(0,a.Lk)("div",B,[(0,a.Lk)("img",{src:e.image,class:"card-img-top",alt:e.subject,style:{height:"180px",width:"100%","object-fit":"contain","background-color":"#f8f9fa"}},null,8,H),(0,a.Lk)("div",ee,[(0,a.Lk)("h5",te,(0,n.v_)(e.subject),1),(0,a.Lk)("p",se,(0,n.v_)(e.location),1),(0,a.Lk)("p",oe,[(0,a.Lk)("strong",null,"£"+(0,n.v_)(e.price),1),t[9]||(t[9]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("small",null,"Spaces: "+(0,n.v_)(e.spaces),1)]),(0,a.Lk)("button",{class:"btn btn-primary w-100",onClick:t=>s.addToCart(e),disabled:0===e.spaces}," Add to Cart ",8,ae)])])]))),128))])])}s(1701);const ce="https://backend-afterschoollessons.onrender.com";var le={name:"LessonList",props:["page","addToCart"],data(){return{lessons:[],sortKey:"subject",sortDir:"asc",searchTerm:""}},async mounted(){await this.loadLessons()},computed:{sortedLessons(){const e=this.sortKey,t="asc"===this.sortDir?1:-1;return this.lessons.slice().sort((s,o)=>{const a=s[e],n=o[e];return a<n?-1*t:a>n?1*t:0})}},methods:{async loadLessons(){console.log("loadLessons() called");const e=await fetch(`${ce}/api/lessons`),t=await e.json();if(!Array.isArray(t))return console.error("Expected an array of lessons, got:",t),void(this.lessons=[]);this.lessons=t.map(e=>({_id:e._id,subject:e.topic,location:e.location,price:e.price,spaces:e.space,image:`${ce}/images/${e.topic.toLowerCase().replace(/\s+/g,"-")}.png`})),console.log("Loaded lessons:",this.lessons.length)},async searchLessons(){const e=this.searchTerm.trim();if(!e){const e=await fetch(`${ce}/api/lessons`),t=await e.json();return void(this.lessons=t.map(e=>({_id:e._id,subject:e.topic,location:e.location,price:e.price,spaces:e.space,image:`${ce}/images/${e.topic.toLowerCase().replace(/\s+/g,"-")}.png`})))}const t=await fetch(`${ce}/api/search?q=${encodeURIComponent(e)}`),s=await t.json();this.lessons=s.map(e=>({_id:e._id,subject:e.topic,location:e.location,price:e.price,spaces:e.space,image:`${ce}/images/${e.topic.toLowerCase().replace(/\s+/g,"-")}.png`})),console.log("Search results:",this.lessons.length)}}};const ie=(0,V.A)(le,[["render",ne]]);var re=ie;const de={class:"container mt-4"},ue={key:0,class:"text-muted"},he={key:1,class:"list-group"},me={class:"flex-grow-1 me-3"},pe={class:"small text-muted"},ke={class:"d-flex align-items-center"},be=["onClick"],ve={class:"mx-2"},ge=["onClick"],ye=["onClick"],Ce={class:"list-group-item d-flex justify-content-between"};function fe(e,t,s,o,c,l){return(0,a.uX)(),(0,a.CE)("div",de,[t[1]||(t[1]=(0,a.Lk)("h2",{class:"mb-3"},"Cart",-1)),0===s.cart.length?((0,a.uX)(),(0,a.CE)("p",ue," Your cart is empty. ")):((0,a.uX)(),(0,a.CE)("ul",he,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.cart,(t,s)=>((0,a.uX)(),(0,a.CE)("li",{key:t.lesson._id||s,class:"list-group-item d-flex justify-content-between align-items-center"},[(0,a.Lk)("div",me,[(0,a.Lk)("strong",null,(0,n.v_)(t.lesson.subject),1),(0,a.Lk)("div",pe,(0,n.v_)(t.lesson.location),1)]),(0,a.Lk)("div",ke,[(0,a.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:t=>e.$emit("decrease-qty",s)},"−",8,be),(0,a.Lk)("span",ve,(0,n.v_)(t.quantity),1),(0,a.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:t=>e.$emit("increase-qty",s)},"+",8,ge),(0,a.Lk)("button",{class:"btn btn-sm btn-outline-danger ms-2",onClick:t=>e.$emit("remove-item",s)}," Remove ",8,ye)])]))),128)),(0,a.Lk)("li",Ce,[t[0]||(t[0]=(0,a.Lk)("strong",null,"Total",-1)),(0,a.Lk)("span",null,"£"+(0,n.v_)(l.totalPrice.toFixed(2)),1)])]))])}var Le={name:"Cart",props:["cart"],emits:["remove-item","increase-qty","decrease-qty"],computed:{totalPrice(){return Array.isArray(this.cart)?this.cart.reduce((e,t)=>{const s=Number(t.lesson.price)||0,o=Number(t.quantity)||0;return e+s*o},0):0}}};const we=(0,V.A)(Le,[["render",fe]]);var xe=we;const _e={class:"mt-4"},Ee={class:"mb-3"},Ae={key:0,class:"text-danger"},je={class:"mb-3"},Fe={key:0,class:"text-danger"},Xe=["disabled"];function Pe(e,t,s,n,c,l){return(0,a.uX)(),(0,a.CE)("div",_e,[t[5]||(t[5]=(0,a.Lk)("h3",{class:"mb-3"},"Checkout",-1)),(0,a.Lk)("form",{onSubmit:t[2]||(t[2]=(0,o.D$)((...e)=>l.handleCheckout&&l.handleCheckout(...e),["prevent"]))},[(0,a.Lk)("div",Ee,[t[3]||(t[3]=(0,a.Lk)("label",{class:"form-label"},"Full Name",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>c.name=e),type:"text",class:"form-control",placeholder:"Enter your full name",required:""},null,512),[[o.Jo,c.name]]),c.name&&!l.isNameValid?((0,a.uX)(),(0,a.CE)("small",Ae," Name must contain letters only. ")):(0,a.Q3)("",!0)]),(0,a.Lk)("div",je,[t[4]||(t[4]=(0,a.Lk)("label",{class:"form-label"},"Phone Number",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>c.phone=e),type:"text",class:"form-control",placeholder:"Enter your phone number",required:""},null,512),[[o.Jo,c.phone]]),c.phone&&!l.isPhoneValid?((0,a.uX)(),(0,a.CE)("small",Fe," Phone must contain numbers only. ")):(0,a.Q3)("",!0)]),(0,a.Lk)("button",{type:"submit",class:"btn btn-primary w-100",disabled:!l.isNameValid||!l.isPhoneValid||0===s.cart.length}," Checkout ",8,Xe)],32)])}var Me={name:"Checkout",props:["cart"],emits:["checkout"],data(){return{name:"",phone:""}},computed:{isNameValid(){return/^[A-Za-z\s]+$/.test(this.name)},isPhoneValid(){return/^[0-9]+$/.test(this.phone)}},methods:{async handleCheckout(){const e="https://backend-afterschoollessons.onrender.com",t={name:this.name,phone:this.phone,items:this.cart.map(e=>({lessonId:e.lesson._id,spaces:e.quantity}))};await fetch(`${e}/api/order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});for(const s of this.cart){const{lesson:t,quantity:o}=s;for(let s=0;s<o;s++)await fetch(`${e}/api/lesson/${t._id}/decrease`,{method:"PUT"})}this.$emit("checkout")}}};const Te=(0,V.A)(Me,[["render",Pe]]);var $e=Te,qe={components:{Navbar:K,LessonList:re,Cart:xe,Checkout:$e},data(){return{activePage:0,cart:[],showCheckoutForm:!1,showAddedModal:{visible:!1,lessonName:"",fromCartIcon:!1},pages:[{link:{text:"Lessons",url:"LessonList.vue"},pageTitle:"Lessons List",content:"This is the list of lessons"},{link:{text:"About",url:"about.html"},pageTitle:"About",content:"This is the about content"}]}},methods:{handleNavClick(e){this.activePage=e,this.showCheckoutForm=!1},async addToCart(e){const t=0===this.cart.length,s=this.cart.find(t=>t.lesson._id===e._id);e.spaces>0&&(s?s.quantity+=1:this.cart.push({lesson:e,quantity:1}),e.spaces--),t&&this.cart.length>0&&(this.showAddedModal.visible=!0,this.showAddedModal.lessonName=e.subject,this.showAddedModal.fromCartIcon=!1)},async removeFromCart(e){const t=this.cart[e],s=t.lesson;s.spaces+=t.quantity,this.cart.splice(e,1),0===this.cart.length&&2===this.activePage&&(this.activePage=0,this.showCheckoutForm=!1)},increaseQuantity(e){const t=this.cart[e],s=t.lesson;s.spaces>0&&(t.quantity+=1,s.spaces--)},decreaseQuantity(e){const t=this.cart[e],s=t.lesson;t.quantity>1?(t.quantity-=1,s.spaces++):this.removeFromCart(e)},completeCheckout(){alert("Order complete!"),this.cart=[],this.activePage=0,this.showCheckoutForm=!1},closeModal(){this.showAddedModal.visible=!1},continueShoppingFromModal(){this.showAddedModal.visible=!1,this.activePage=0,this.showCheckoutForm=!1},goToCheckoutFromModal(){this.cart.length&&(this.showAddedModal.visible=!1,this.activePage=2,this.showCheckoutForm=!0)},openCartFromIcon(){this.cart.length&&(this.showAddedModal.visible=!0,this.showAddedModal.fromCartIcon=!0)}}};const Ie=(0,V.A)(qe,[["render",M]]);var Ne=Ie;(0,o.Ef)(Ne).mount("#app")}},t={};function s(o){var a=t[o];if(void 0!==a)return a.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,s),n.exports}s.m=e,function(){var e=[];s.O=function(t,o,a,n){if(!o){var c=1/0;for(d=0;d<e.length;d++){o=e[d][0],a=e[d][1],n=e[d][2];for(var l=!0,i=0;i<o.length;i++)(!1&n||c>=n)&&Object.keys(s.O).every(function(e){return s.O[e](o[i])})?o.splice(i--,1):(l=!1,n<c&&(c=n));if(l){e.splice(d--,1);var r=a();void 0!==r&&(t=r)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[o,a,n]}}(),function(){s.d=function(e,t){for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,n,c=o[0],l=o[1],i=o[2],r=0;if(c.some(function(t){return 0!==e[t]})){for(a in l)s.o(l,a)&&(s.m[a]=l[a]);if(i)var d=i(s)}for(t&&t(o);r<c.length;r++)n=c[r],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(d)},o=self["webpackChunkafter_school_lessons"]=self["webpackChunkafter_school_lessons"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=s.O(void 0,[504],function(){return s(2559)});o=s.O(o)})();
//# sourceMappingURL=app.ff64fd70.js.map