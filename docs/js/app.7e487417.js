(function(){"use strict";var e={7787:function(e,t,s){var o=s(3751),a=s(641),n=s(33);const l={key:0,class:"position-fixed top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center",style:{background:"rgba(0,0,0,0.4)","z-index":"1050"}},c={class:"bg-white rounded shadow p-4",style:{"min-width":"360px","max-width":"480px"}},r={class:"d-flex justify-content-between align-items-center mb-2"},i={class:"mb-0"},d={key:0},u={key:1},m={key:0},h={key:1,class:"text-muted"},p={key:2,class:"list-group mb-3",style:{"max-height":"260px","overflow-y":"auto"}},k={class:"flex-grow-1 me-3"},b={class:"small text-muted"},v={class:"d-flex align-items-center"},g=["onClick"],y={class:"mx-2"},C=["onClick"],L=["onClick"],f={class:"d-flex justify-content-center gap-2"},w=["disabled"],x={class:"container mt-3"},_={key:0},E={key:1},j={class:"mb-3"},A={key:2},F={class:"row"},X={class:"col-md-6"},P={key:0,class:"col-md-6"},T={key:3,class:"mt-4"},M={class:"text-center"},$={class:"mb-3"};function N(e,t,s,o,N,q){const I=(0,a.g2)("navbar"),S=(0,a.g2)("LessonList"),Q=(0,a.g2)("Cart"),O=(0,a.g2)("Checkout");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.bF)(I,{pages:N.pages,"active-page":N.activePage,"nav-link-click":q.handleNavClick,cart:N.cart,onOpenCart:q.openCartFromIcon},null,8,["pages","active-page","nav-link-click","cart","onOpenCart"]),N.showAddedModal.visible?((0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("div",c,[(0,a.Lk)("div",r,[(0,a.Lk)("h5",i,[N.showAddedModal.fromCartIcon?((0,a.uX)(),(0,a.CE)("span",d,"Your cart")):((0,a.uX)(),(0,a.CE)("span",u,"Item added to cart"))]),(0,a.Lk)("button",{type:"button",class:"btn-close","aria-label":"Close",onClick:t[0]||(t[0]=(...e)=>q.closeModal&&q.closeModal(...e))})]),!N.showAddedModal.fromCartIcon&&N.showAddedModal.lessonName?((0,a.uX)(),(0,a.CE)("p",m,[(0,a.Lk)("strong",null,(0,n.v_)(N.showAddedModal.lessonName),1),t[4]||(t[4]=(0,a.eW)(" has been added to your cart. ",-1))])):(0,a.Q3)("",!0),0===N.cart.length?((0,a.uX)(),(0,a.CE)("div",h," Your cart is empty. ")):((0,a.uX)(),(0,a.CE)("ul",p,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(N.cart,(e,t)=>((0,a.uX)(),(0,a.CE)("li",{key:e.lesson._id||t,class:"list-group-item d-flex justify-content-between align-items-center"},[(0,a.Lk)("div",k,[(0,a.Lk)("strong",null,(0,n.v_)(e.lesson.subject),1),(0,a.Lk)("div",b,(0,n.v_)(e.lesson.location),1)]),(0,a.Lk)("div",v,[(0,a.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:e=>q.decreaseQuantity(t)},"-",8,g),(0,a.Lk)("span",y,(0,n.v_)(e.quantity),1),(0,a.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:e=>q.increaseQuantity(t)},"+",8,C),(0,a.Lk)("button",{class:"btn btn-sm btn-outline-danger ms-2",onClick:e=>q.removeFromCart(t)}," Remove ",8,L)])]))),128))])),(0,a.Lk)("div",f,[(0,a.Lk)("button",{class:"btn btn-outline-secondary",onClick:t[1]||(t[1]=(...e)=>q.continueShoppingFromModal&&q.continueShoppingFromModal(...e))}," Continue shopping "),(0,a.Lk)("button",{class:"btn btn-primary",disabled:0===N.cart.length,onClick:t[2]||(t[2]=(...e)=>q.goToCheckoutFromModal&&q.goToCheckoutFromModal(...e))}," Go to checkout ",8,w)])])])):(0,a.Q3)("",!0),(0,a.Lk)("div",x,[0===N.activePage?((0,a.uX)(),(0,a.CE)("div",_,[(0,a.bF)(S,{page:N.pages[0],"add-to-cart":q.addToCart},null,8,["page","add-to-cart"])])):1===N.activePage?((0,a.uX)(),(0,a.CE)("div",E,[(0,a.Lk)("h1",j,(0,n.v_)(N.pages[1].pageTitle),1),(0,a.Lk)("p",null,(0,n.v_)(N.pages[1].content),1)])):2===N.activePage?((0,a.uX)(),(0,a.CE)("div",A,[t[6]||(t[6]=(0,a.Lk)("h1",{class:"mb-3"},"Checkout",-1)),(0,a.Lk)("div",F,[(0,a.Lk)("div",X,[(0,a.bF)(Q,{cart:N.cart,onRemoveItem:q.removeFromCart,onIncreaseQty:q.increaseQuantity,onDecreaseQty:q.decreaseQuantity},null,8,["cart","onRemoveItem","onIncreaseQty","onDecreaseQty"])]),N.showCheckoutForm&&N.cart.length>0?((0,a.uX)(),(0,a.CE)("div",P,[t[5]||(t[5]=(0,a.Lk)("h2",{class:"h4 mb-3"},"Checkout",-1)),(0,a.bF)(O,{cart:N.cart,onCheckout:q.completeCheckout},null,8,["cart","onCheckout"])])):(0,a.Q3)("",!0)])])):3===N.activePage&&N.orderSummary?((0,a.uX)(),(0,a.CE)("div",T,[(0,a.Lk)("div",M,[(0,a.Lk)("h1",$,"Thank you, "+(0,n.v_)(N.orderSummary.name)+"!",1),t[9]||(t[9]=(0,a.Lk)("p",{class:"lead"}," Your order is complete. ",-1)),(0,a.Lk)("p",null,[t[7]||(t[7]=(0,a.eW)(" Your order number is ",-1)),(0,a.Lk)("strong",null,"#"+(0,n.v_)(N.orderSummary.orderNumber),1),t[8]||(t[8]=(0,a.eW)(". ",-1))]),t[10]||(t[10]=(0,a.Lk)("p",{class:"text-muted"}," A confirmation receipt will be sent to your email as well. ",-1)),(0,a.Lk)("button",{class:"btn btn-primary mt-3",onClick:t[3]||(t[3]=e=>q.handleNavClick(0))}," Back to Lessons ")])])):(0,a.Q3)("",!0)])])}s(4114),s(8111),s(116);const q={class:"navbar navbar-expand-lg navbar-light bg-light",style:{padding:"0.5rem 1.2rem","border-bottom":"1px solid #ddd"}},I={class:"container"},S={class:"navbar-nav me-auto mb-2 mb-lg-0"},Q=["onClick"],O=["disabled"],V={key:0,class:"badge rounded-pill bg-danger",style:{position:"absolute",top:"2px",right:"4px","font-size":"0.85rem","min-width":"18px"}};function D(e,t,s,l,c,r){return(0,a.uX)(),(0,a.CE)("nav",q,[(0,a.Lk)("div",I,[t[3]||(t[3]=(0,a.Lk)("a",{class:"navbar-brand fw-semibold",style:{"font-size":"1.55rem","font-weight":"600"}}," After School Lessons ",-1)),(0,a.Lk)("ul",S,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.pages,(e,t)=>((0,a.uX)(),(0,a.CE)("li",{key:t,class:"nav-item"},[(0,a.Lk)("a",{href:"#",class:(0,n.C4)(["nav-link",{active:s.activePage===t}]),onClick:(0,o.D$)(e=>s.navLinkClick(t),["prevent"]),style:{"font-size":"1.15rem","font-weight":"500"}},(0,n.v_)(e.link.text),11,Q)]))),128))]),(0,a.Lk)("button",{class:"btn btn-light position-relative d-flex flex-column align-items-center justify-content-center",disabled:0===r.cartCount,onClick:t[0]||(t[0]=t=>e.$emit("open-cart")),style:{width:"80px",height:"80px","border-radius":"9999px",padding:"6px"}},[t[1]||(t[1]=(0,a.Lk)("i",{class:"bi bi-cart2",style:{"font-size":"2.1rem"}},null,-1)),t[2]||(t[2]=(0,a.Lk)("span",{style:{"font-size":"0.95rem","margin-top":"3px"}},"Cart",-1)),r.cartCount>0?((0,a.uX)(),(0,a.CE)("span",V,(0,n.v_)(r.cartCount),1)):(0,a.Q3)("",!0)],8,O)])])}s(8237);var K={name:"Navbar",props:["pages","activePage","navLinkClick","cart"],computed:{cartCount(){return Array.isArray(this.cart)?this.cart.reduce((e,t)=>e+(t.quantity||0),0):0}}},z=s(6262);const U=(0,z.A)(K,[["render",D]]);var R=U;const Y={class:"container mt-4"},J={class:"mb-4"},W={class:"row mb-3"},B={class:"col-md-6"},G={class:"row mb-3"},Z={class:"col-md-4"},H={class:"col-md-4"},ee={class:"row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4"},te={class:"card h-100 shadow-sm"},se=["src","alt"],oe={class:"card-body"},ae={class:"card-title"},ne={class:"card-text text-muted mb-2"},le={class:"mb-2"},ce=["onClick","disabled"];function re(e,t,s,l,c,r){return(0,a.uX)(),(0,a.CE)("div",Y,[(0,a.Lk)("h1",J,(0,n.v_)(s.page.pageTitle),1),(0,a.Lk)("div",W,[(0,a.Lk)("div",B,[t[4]||(t[4]=(0,a.Lk)("label",{class:"form-label"},"Search",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>c.searchTerm=e),onInput:t[1]||(t[1]=(...e)=>r.searchLessons&&r.searchLessons(...e)),type:"text",class:"form-control",placeholder:"Search by subject, location, price, spaces..."},null,544),[[o.Jo,c.searchTerm]])])]),(0,a.Lk)("div",G,[(0,a.Lk)("div",Z,[t[6]||(t[6]=(0,a.Lk)("label",{class:"form-label"},"Sort by",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>c.sortKey=e),class:"form-select"},[...t[5]||(t[5]=[(0,a.Lk)("option",{value:"subject"},"Subject",-1),(0,a.Lk)("option",{value:"location"},"Location",-1),(0,a.Lk)("option",{value:"price"},"Price",-1),(0,a.Lk)("option",{value:"spaces"},"Spaces",-1)])],512),[[o.u1,c.sortKey]])]),(0,a.Lk)("div",H,[t[8]||(t[8]=(0,a.Lk)("label",{class:"form-label"},"Order",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>c.sortDir=e),class:"form-select"},[...t[7]||(t[7]=[(0,a.Lk)("option",{value:"asc"},"Ascending",-1),(0,a.Lk)("option",{value:"desc"},"Descending",-1)])],512),[[o.u1,c.sortDir]])])]),(0,a.Lk)("div",ee,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.sortedLessons,e=>((0,a.uX)(),(0,a.CE)("div",{class:"col",key:e._id},[(0,a.Lk)("div",te,[(0,a.Lk)("img",{src:e.image,class:"card-img-top",alt:e.subject,style:{height:"180px",width:"100%","object-fit":"contain","background-color":"#f8f9fa"}},null,8,se),(0,a.Lk)("div",oe,[(0,a.Lk)("h5",ae,(0,n.v_)(e.subject),1),(0,a.Lk)("p",ne,(0,n.v_)(e.location),1),(0,a.Lk)("p",le,[(0,a.Lk)("strong",null,"£"+(0,n.v_)(e.price),1),t[9]||(t[9]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("small",null,"Spaces: "+(0,n.v_)(e.spaces),1)]),(0,a.Lk)("button",{class:"btn btn-primary w-100",onClick:t=>s.addToCart(e),disabled:0===e.spaces}," Add to Cart ",8,ce)])])]))),128))])])}s(1701);const ie="https://backend-afterschoollessons.onrender.com";var de={name:"LessonList",props:["page","addToCart"],data(){return{lessons:[],sortKey:"subject",sortDir:"asc",searchTerm:""}},async mounted(){await this.loadLessons()},computed:{sortedLessons(){const e=this.sortKey,t="asc"===this.sortDir?1:-1;return this.lessons.slice().sort((s,o)=>{const a=s[e],n=o[e];return a<n?-1*t:a>n?1*t:0})}},methods:{async loadLessons(){console.log("loadLessons() called");const e=await fetch(`${ie}/api/lessons`),t=await e.json();if(!Array.isArray(t))return console.error("Expected an array of lessons, got:",t),void(this.lessons=[]);this.lessons=t.map(e=>({_id:e._id,subject:e.topic,location:e.location,price:e.price,spaces:e.space,image:`${ie}/images/${e.topic.toLowerCase().replace(/\s+/g,"-")}.png`})),console.log("Loaded lessons:",this.lessons.length)},async searchLessons(){const e=this.searchTerm.trim();if(!e){const e=await fetch(`${ie}/api/lessons`),t=await e.json();return void(this.lessons=t.map(e=>({_id:e._id,subject:e.topic,location:e.location,price:e.price,spaces:e.space,image:`${ie}/images/${e.topic.toLowerCase().replace(/\s+/g,"-")}.png`})))}const t=await fetch(`${ie}/api/search?q=${encodeURIComponent(e)}`),s=await t.json();this.lessons=s.map(e=>({_id:e._id,subject:e.topic,location:e.location,price:e.price,spaces:e.space,image:`${ie}/images/${e.topic.toLowerCase().replace(/\s+/g,"-")}.png`})),console.log("Search results:",this.lessons.length)}}};const ue=(0,z.A)(de,[["render",re]]);var me=ue;const he={class:"container mt-4"},pe={key:0,class:"text-muted"},ke={key:1,class:"list-group"},be={class:"flex-grow-1 me-3"},ve={class:"small text-muted"},ge={class:"d-flex align-items-center"},ye=["onClick"],Ce={class:"mx-2"},Le=["onClick"],fe=["onClick"],we={class:"list-group-item d-flex justify-content-between"};function xe(e,t,s,o,l,c){return(0,a.uX)(),(0,a.CE)("div",he,[t[1]||(t[1]=(0,a.Lk)("h2",{class:"mb-3"},"Cart",-1)),0===s.cart.length?((0,a.uX)(),(0,a.CE)("p",pe," Your cart is empty. ")):((0,a.uX)(),(0,a.CE)("ul",ke,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.cart,(t,s)=>((0,a.uX)(),(0,a.CE)("li",{key:t.lesson._id||s,class:"list-group-item d-flex justify-content-between align-items-center"},[(0,a.Lk)("div",be,[(0,a.Lk)("strong",null,(0,n.v_)(t.lesson.subject),1),(0,a.Lk)("div",ve,(0,n.v_)(t.lesson.location),1)]),(0,a.Lk)("div",ge,[(0,a.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:t=>e.$emit("decrease-qty",s)},"−",8,ye),(0,a.Lk)("span",Ce,(0,n.v_)(t.quantity),1),(0,a.Lk)("button",{class:"btn btn-sm btn-outline-secondary",onClick:t=>e.$emit("increase-qty",s)},"+",8,Le),(0,a.Lk)("button",{class:"btn btn-sm btn-outline-danger ms-2",onClick:t=>e.$emit("remove-item",s)}," Remove ",8,fe)])]))),128)),(0,a.Lk)("li",we,[t[0]||(t[0]=(0,a.Lk)("strong",null,"Total",-1)),(0,a.Lk)("span",null,"£"+(0,n.v_)(c.totalPrice.toFixed(2)),1)])]))])}var _e={name:"Cart",props:["cart"],emits:["remove-item","increase-qty","decrease-qty"],computed:{totalPrice(){return Array.isArray(this.cart)?this.cart.reduce((e,t)=>{const s=Number(t.lesson.price)||0,o=Number(t.quantity)||0;return e+s*o},0):0}}};const Ee=(0,z.A)(_e,[["render",xe]]);var je=Ee;const Ae={class:"mt-4"},Fe={class:"mb-3"},Xe={key:0,class:"text-danger"},Pe={class:"mb-3"},Te={key:0,class:"text-danger"},Me=["disabled"];function $e(e,t,s,n,l,c){return(0,a.uX)(),(0,a.CE)("div",Ae,[t[5]||(t[5]=(0,a.Lk)("h3",{class:"mb-3"},"Checkout",-1)),(0,a.Lk)("form",{onSubmit:t[2]||(t[2]=(0,o.D$)((...e)=>c.handleCheckout&&c.handleCheckout(...e),["prevent"]))},[(0,a.Lk)("div",Fe,[t[3]||(t[3]=(0,a.Lk)("label",{class:"form-label"},"Full Name",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>l.name=e),type:"text",class:"form-control",placeholder:"Enter your full name",required:""},null,512),[[o.Jo,l.name]]),l.name&&!c.isNameValid?((0,a.uX)(),(0,a.CE)("small",Xe," Name must contain letters only. ")):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Pe,[t[4]||(t[4]=(0,a.Lk)("label",{class:"form-label"},"Phone Number",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>l.phone=e),type:"text",class:"form-control",placeholder:"Enter your phone number",required:""},null,512),[[o.Jo,l.phone]]),l.phone&&!c.isPhoneValid?((0,a.uX)(),(0,a.CE)("small",Te," Phone must contain numbers only. ")):(0,a.Q3)("",!0)]),(0,a.Lk)("button",{type:"submit",class:"btn btn-primary w-100",disabled:!c.isNameValid||!c.isPhoneValid||0===s.cart.length}," Checkout ",8,Me)],32)])}var Ne={name:"Checkout",props:["cart"],emits:["checkout"],data(){return{name:"",phone:""}},computed:{isNameValid(){return/^[A-Za-z\s]+$/.test(this.name)},isPhoneValid(){return/^[0-9]+$/.test(this.phone)}},methods:{async handleCheckout(){const e="https://backend-afterschoollessons.onrender.com",t={name:this.name,phone:this.phone,items:this.cart.map(e=>({lessonId:e.lesson._id,subject:e.lesson.subject,spaces:e.quantity}))},s=await fetch(`${e}/api/order`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),o=await s.json(),a=o.orderNumber;for(const n of this.cart){const{lesson:t,quantity:s}=n;for(let o=0;o<s;o++)await fetch(`${e}/api/lesson/${t._id}/decrease`,{method:"PUT"})}this.$emit("checkout",{name:this.name,phone:this.phone,orderNumber:a})}}};const qe=(0,z.A)(Ne,[["render",$e]]);var Ie=qe,Se={components:{Navbar:R,LessonList:me,Cart:je,Checkout:Ie},data(){return{activePage:0,cart:[],showCheckoutForm:!1,showAddedModal:{visible:!1,lessonName:"",fromCartIcon:!1},orderSummary:null,pages:[{link:{text:"Lessons",url:"LessonList.vue"},pageTitle:"Lessons List",content:"This is the list of lessons"},{link:{text:"About",url:"about.html"},pageTitle:"About",content:"This is the about content"}]}},methods:{handleNavClick(e){this.activePage=e,this.showCheckoutForm=!1},async addToCart(e){const t=0===this.cart.length,s=this.cart.find(t=>t.lesson._id===e._id);e.spaces>0&&(s?s.quantity+=1:this.cart.push({lesson:e,quantity:1}),e.spaces--),t&&this.cart.length>0&&(this.showAddedModal.visible=!0,this.showAddedModal.lessonName=e.subject,this.showAddedModal.fromCartIcon=!1)},async removeFromCart(e){const t=this.cart[e],s=t.lesson;s.spaces+=t.quantity,this.cart.splice(e,1),0===this.cart.length&&2===this.activePage&&(this.activePage=0,this.showCheckoutForm=!1)},increaseQuantity(e){const t=this.cart[e],s=t.lesson;s.spaces>0&&(t.quantity+=1,s.spaces--)},decreaseQuantity(e){const t=this.cart[e],s=t.lesson;t.quantity>1?(t.quantity-=1,s.spaces++):this.removeFromCart(e)},completeCheckout(e){this.orderSummary=e,this.cart=[],this.showCheckoutForm=!1,this.activePage=3},closeModal(){this.showAddedModal.visible=!1},continueShoppingFromModal(){this.showAddedModal.visible=!1,this.activePage=0,this.showCheckoutForm=!1},goToCheckoutFromModal(){this.cart.length&&(this.showAddedModal.visible=!1,this.activePage=2,this.showCheckoutForm=!0)},openCartFromIcon(){this.cart.length&&(this.showAddedModal.visible=!0,this.showAddedModal.fromCartIcon=!0)}}};const Qe=(0,z.A)(Se,[["render",N]]);var Oe=Qe;(0,o.Ef)(Oe).mount("#app")}},t={};function s(o){var a=t[o];if(void 0!==a)return a.exports;var n=t[o]={exports:{}};return e[o].call(n.exports,n,n.exports,s),n.exports}s.m=e,function(){var e=[];s.O=function(t,o,a,n){if(!o){var l=1/0;for(d=0;d<e.length;d++){o=e[d][0],a=e[d][1],n=e[d][2];for(var c=!0,r=0;r<o.length;r++)(!1&n||l>=n)&&Object.keys(s.O).every(function(e){return s.O[e](o[r])})?o.splice(r--,1):(c=!1,n<l&&(l=n));if(c){e.splice(d--,1);var i=a();void 0!==i&&(t=i)}}return t}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[o,a,n]}}(),function(){s.d=function(e,t){for(var o in t)s.o(t,o)&&!s.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,o){var a,n,l=o[0],c=o[1],r=o[2],i=0;if(l.some(function(t){return 0!==e[t]})){for(a in c)s.o(c,a)&&(s.m[a]=c[a]);if(r)var d=r(s)}for(t&&t(o);i<l.length;i++)n=l[i],s.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return s.O(d)},o=self["webpackChunkafter_school_lessons"]=self["webpackChunkafter_school_lessons"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=s.O(void 0,[504],function(){return s(7787)});o=s.O(o)})();
//# sourceMappingURL=app.7e487417.js.map